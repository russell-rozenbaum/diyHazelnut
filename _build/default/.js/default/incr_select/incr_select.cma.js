// Generated by js_of_ocaml
//# buildInfo:effects=false, kind=cma, use-js-string=true, version=5.8.1+5.8.1

//# unitInfo: Provides: Incr_select__
(function
  (globalThis){
   "use strict";
   var runtime = globalThis.jsoo_runtime, Incr_select = [0];
   runtime.caml_register_global(0, Incr_select, "Incr_select__");
   return;
  }
  (globalThis));

//# unitInfo: Provides: Incr_select__Incr_select_intf
//# unitInfo: Requires: Expect_test_collector, Ppx_bench_lib__Benchmark_accumulator, Ppx_inline_test_lib__Runtime, Ppx_module_timer_runtime
(function
  (globalThis){
   "use strict";
   var
    runtime = globalThis.jsoo_runtime,
    cst_Incr_select_Incr_select_in = "Incr_select__Incr_select_intf",
    cst_incr_select = "incr_select";
   function caml_call1(f, a0){
    return (f.l >= 0 ? f.l : f.l = f.length) == 1
            ? f(a0)
            : runtime.caml_call_gen(f, [a0]);
   }
   function caml_call2(f, a0, a1){
    return (f.l >= 0 ? f.l : f.l = f.length) == 2
            ? f(a0, a1)
            : runtime.caml_call_gen(f, [a0, a1]);
   }
   var
    global_data = runtime.caml_get_global_data(),
    cst = "",
    Ppx_module_timer_runtime = global_data.Ppx_module_timer_runtime,
    Ppx_bench_lib_Benchmark_accumu =
      global_data.Ppx_bench_lib__Benchmark_accumulator,
    Expect_test_collector = global_data.Expect_test_collector,
    Ppx_inline_test_lib_Runtime = global_data.Ppx_inline_test_lib__Runtime;
   caml_call1(Ppx_module_timer_runtime[4], cst_Incr_select_Incr_select_in);
   caml_call1(Ppx_bench_lib_Benchmark_accumu[1][1], cst_incr_select);
   caml_call1(Expect_test_collector[5][1], "src/incr_select_intf.ml");
   caml_call2(Ppx_inline_test_lib_Runtime[2], cst_incr_select, cst);
   caml_call1(Ppx_inline_test_lib_Runtime[3], cst_incr_select);
   caml_call1(Expect_test_collector[5][2], 0);
   caml_call1(Ppx_bench_lib_Benchmark_accumu[1][2], 0);
   caml_call1(Ppx_module_timer_runtime[5], cst_Incr_select_Incr_select_in);
   var Incr_select_Incr_select_intf = [0];
   runtime.caml_register_global
    (11, Incr_select_Incr_select_intf, cst_Incr_select_Incr_select_in);
   return;
  }
  (globalThis));

//# unitInfo: Provides: Incr_select
//# unitInfo: Requires: Core, Core__Fn, Core__Hash_set, Core__Hashtbl, Core__List, Core__Option, Expect_test_collector, Ppx_bench_lib__Benchmark_accumulator, Ppx_inline_test_lib__Runtime, Ppx_module_timer_runtime
(function
  (globalThis){
   "use strict";
   var
    runtime = globalThis.jsoo_runtime,
    cst_Incr_select = "Incr_select",
    cst_incr_select = "incr_select";
   function caml_call1(f, a0){
    return (f.l >= 0 ? f.l : f.l = f.length) == 1
            ? f(a0)
            : runtime.caml_call_gen(f, [a0]);
   }
   function caml_call2(f, a0, a1){
    return (f.l >= 0 ? f.l : f.l = f.length) == 2
            ? f(a0, a1)
            : runtime.caml_call_gen(f, [a0, a1]);
   }
   function caml_call3(f, a0, a1, a2){
    return (f.l >= 0 ? f.l : f.l = f.length) == 3
            ? f(a0, a1, a2)
            : runtime.caml_call_gen(f, [a0, a1, a2]);
   }
   function caml_call4(f, a0, a1, a2, a3){
    return (f.l >= 0 ? f.l : f.l = f.length) == 4
            ? f(a0, a1, a2, a3)
            : runtime.caml_call_gen(f, [a0, a1, a2, a3]);
   }
   var
    global_data = runtime.caml_get_global_data(),
    cst = "",
    Core_Hash_set = global_data.Core__Hash_set,
    Core_List = global_data.Core__List,
    Core_Hashtbl = global_data.Core__Hashtbl,
    Core_Option = global_data.Core__Option,
    Core = global_data.Core,
    Core_Fn = global_data.Core__Fn,
    Ppx_module_timer_runtime = global_data.Ppx_module_timer_runtime,
    Ppx_bench_lib_Benchmark_accumu =
      global_data.Ppx_bench_lib__Benchmark_accumulator,
    Expect_test_collector = global_data.Expect_test_collector,
    Ppx_inline_test_lib_Runtime = global_data.Ppx_inline_test_lib__Runtime;
   caml_call1(Ppx_module_timer_runtime[4], cst_Incr_select);
   caml_call1(Ppx_bench_lib_Benchmark_accumu[1][1], cst_incr_select);
   caml_call1(Expect_test_collector[5][1], "src/incr_select.ml");
   caml_call2(Ppx_inline_test_lib_Runtime[2], cst_incr_select, cst);
   caml_call1(Ppx_inline_test_lib_Runtime[3], cst_incr_select);
   caml_call1(Expect_test_collector[5][2], 0);
   caml_call1(Ppx_bench_lib_Benchmark_accumu[1][2], 0);
   caml_call1(Ppx_module_timer_runtime[5], cst_Incr_select);
   var
    Incr_select =
      [0,
       function(Incr){
        var E = Incr[78], hashtbl_size = 10;
        function setup_generator(hashable, compute_output, make_input_node){
         var
          necessary_dependencies =
            caml_call4(Core_Hashtbl[84][1], 0, [0, hashtbl_size], hashable, 0);
         function make_key_stale(key){
          var
           _m_ = E[2][4],
           _n_ = caml_call2(Core_Hashtbl[53], necessary_dependencies, key),
           _o_ = caml_call2(Core_Option[34], _n_, 0);
          return caml_call2(Core_List[9], _o_, _m_);
         }
         var input_node = caml_call1(make_input_node, make_key_stale);
         caml_call2(Incr[58], input_node, Incr[57][6]);
         return caml_call1
                 (Core[258],
                  function(key){
                   var
                    input_dep = caml_call2(E[1][2], 0, input_node),
                    output_node = [];
                   runtime.caml_update_dummy
                    (output_node,
                     [246,
                      function(_h_){
                       return caml_call2
                               (E[2][2],
                                [0,
                                 function(is_now_observable){
                                  if(! is_now_observable)
                                   return caml_call3
                                           (Core_Hashtbl[37],
                                            necessary_dependencies,
                                            key,
                                            function(param){
                                             if(! param) return 0;
                                             var
                                              l = param[1],
                                              _j_ = caml_call1(Core[237], output_node),
                                              _k_ = caml_call1(Core[246], _j_),
                                              _l_ = caml_call1(Core_Fn[2], _k_),
                                              l$0 = caml_call2(Core_List[50], l, _l_);
                                             return l$0 ? [0, l$0] : 0;
                                            });
                                  var _i_ = caml_call1(Core[237], output_node);
                                  return caml_call3
                                          (Core_Hashtbl[78], necessary_dependencies, key, _i_);
                                 }],
                                function(param){return caml_call1(compute_output, key);});
                      }]);
                   var output_node$0 = caml_call1(Core[237], output_node);
                   caml_call2(E[2][6], output_node$0, input_dep);
                   return caml_call1(E[2][3], output_node$0);
                  });
        }
        function update_one(input, selected, make_stale){
         return caml_call2
                 (Incr[9],
                  input,
                  function(inp){
                   caml_call2(Core_Option[41], inp, make_stale);
                   caml_call2(Core_Option[41], selected[1], make_stale);
                   selected[1] = inp;
                   return 0;
                  });
        }
        function select_one(H){
         return function(input){
          var selected = [0, 0];
          function compute_output(key){
           var match = selected[1];
           if(! match) return 0;
           var key$0 = match[1], _g_ = caml_call2(H[1], key, key$0);
           return caml_call2(Core[90], _g_, 0);
          }
          function make_input_node(make_key_stale){
           return update_one(input, selected, make_key_stale);
          }
          return setup_generator(H[4], compute_output, make_input_node);};
        }
        function select_one$0(h, input){
         var _f_ = caml_call2(Incr[9], input, Core_Option[53]);
         return select_one(h)(_f_);
        }
        function select_one_value(H){
         return function(default$0, input){
          var selected = [0, 0];
          function compute_output(key){
           var _d_ = selected[1];
           if(! _d_) return default$0;
           var
            match = _d_[1],
            data = match[2],
            key$0 = match[1],
            _e_ = caml_call2(H[1], key, key$0);
           return caml_call2(Core[90], _e_, 0) ? data : default$0;
          }
          function make_input_node(make_key_stale){
           return update_one
                   (input,
                    selected,
                    function(param){
                     var key = param[1];
                     return caml_call1(make_key_stale, key);
                    });
          }
          return setup_generator(H[4], compute_output, make_input_node);};
        }
        function select_one_value$0(h, default$0, input){
         var _c_ = caml_call2(Incr[9], input, Core_Option[53]);
         return select_one_value(h)(default$0, _c_);
        }
        function select_many_values(H){
         return function(default$0, input){
          var
           hashable = H[4],
           selected =
             caml_call4
              (Core_Hashtbl[84][1], 0, [0, hashtbl_size], hashable, 0);
          function compute_output(key){
           var _b_ = caml_call2(Core_Hashtbl[53], selected, key);
           return caml_call2(Core_Option[34], _b_, default$0);
          }
          function make_input_node(make_key_stale){
           return caml_call2
                   (Incr[9],
                    input,
                    function(inp){
                     caml_call2(Core_Hashtbl[19], selected, make_key_stale);
                     caml_call1(Core_Hashtbl[16], selected);
                     return caml_call2
                             (Core_List[9],
                              inp,
                              function(param){
                               var data = param[2], key = param[1];
                               caml_call1(make_key_stale, key);
                               return caml_call3(Core_Hashtbl[34], selected, key, data);
                              });
                    });
          }
          return setup_generator(hashable, compute_output, make_input_node);};
        }
        function select_many(H){
         return function(input){
          var
           hashable = H[4],
           selected =
             caml_call4
              (Core_Hash_set[38][1], 0, [0, hashtbl_size], hashable, 0);
          function compute_output(key){
           return caml_call2(Core_Hash_set[20], selected, key);
          }
          function make_input_node(make_key_stale){
           return caml_call2
                   (Incr[9],
                    input,
                    function(inp){
                     var old_set = caml_call1(Core_Hash_set[21], selected);
                     caml_call1(Core_Hash_set[28], selected);
                     caml_call2
                      (Core_List[9],
                       inp,
                       function(key){
                        if(1 - caml_call2(Core_Hash_set[20], old_set, key))
                         caml_call1(make_key_stale, key);
                        return caml_call2(Core_Hash_set[22], selected, key);
                       });
                     return caml_call2
                             (Core_Hash_set[6],
                              old_set,
                              function(key){
                               var _a_ = 1 - caml_call2(Core_Hash_set[20], selected, key);
                               return _a_ ? caml_call1(make_key_stale, key) : _a_;
                              });
                    });
          }
          return setup_generator(hashable, compute_output, make_input_node);};
        }
        return [0,
                select_one$0,
                select_one,
                select_one_value$0,
                select_one_value,
                select_many,
                select_many_values];
       }];
   runtime.caml_register_global(17, Incr_select, cst_Incr_select);
   return;
  }
  (globalThis));

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLjAsImZpbGUiOiJpbmNyX3NlbGVjdC5jbWEuanMiLCJzb3VyY2VSb290IjoiIiwibmFtZXMiOlsiaGFzaHRibF9zaXplIiwic2V0dXBfZ2VuZXJhdG9yIiwiaGFzaGFibGUiLCJjb21wdXRlX291dHB1dCIsIm1ha2VfaW5wdXRfbm9kZSIsIm5lY2Vzc2FyeV9kZXBlbmRlbmNpZXMiLCJtYWtlX2tleV9zdGFsZSIsImtleSIsImlucHV0X25vZGUiLCJpbnB1dF9kZXAiLCJvdXRwdXRfbm9kZSIsImlzX25vd19vYnNlcnZhYmxlIiwibCIsImwkMCIsIm91dHB1dF9ub2RlJDAiLCJ1cGRhdGVfb25lIiwiaW5wdXQiLCJzZWxlY3RlZCIsIm1ha2Vfc3RhbGUiLCJpbnAiLCJzZWxlY3Rfb25lIiwiSCIsImtleSQwIiwic2VsZWN0X29uZSQwIiwiaCIsInNlbGVjdF9vbmVfdmFsdWUiLCJkZWZhdWx0JDAiLCJkYXRhIiwic2VsZWN0X29uZV92YWx1ZSQwIiwic2VsZWN0X21hbnlfdmFsdWVzIiwic2VsZWN0X21hbnkiLCJvbGRfc2V0Il0sInNvdXJjZXMiOlsiL1VzZXJzL3J1c3NlbGxyb3plbmJhdW0vLm9wYW0vZGl5LWhhemVsbnV0L2xpYi9pbmNyX3NlbGVjdC9pbmNyX3NlbGVjdC5tbCJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7OztFOzs7Ozs7Ozs7Ozs7Rzs7Ozs7Rzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztFOzs7Ozs7Ozs7Ozs7Rzs7Ozs7Rzs7Ozs7Rzs7Ozs7Rzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OzswQkFPTUE7aUJBY0FDLGdCQUNHQyxVQUNDQyxnQkFDQUM7U0FHdUI7VUFBekJDO1lBQXlCLHVDQXBCM0JMLGVBZUdFO2tCQU9DSSxlQUFlQztVQUNqQjs7V0FBQSxNQUFBLDZCQUhBRix3QkFFaUJFO1dBQ2pCLE1BQUE7VUFBQSxPQUFBO1NBRWlDO1NBRW5DLElBTkdDLGFBTUgsV0FWSUosaUJBS0FFO1NBU04scUJBVktFO1NBV0MsT0FBQTs7MkJBQUtEO21C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bEIsT0FBQSw4QkFUSlUsVUFPc0JWO3VCQUdLO3FCQUdGLE9BQUE7OzhCQVRyQndCO3VDQVMwQnhCOytCQUNyQixjQUFBLDhCQWRUVSxVQWE4QlY7NENBRTFCLFdBYmFELGdCQVdhQzs4QkFFUjtvQkFDckI7VUFBQztVQUVOLE9BeElFTixnQkFxSEVDLFVBRUFDLGdCQUNBQyxpQkFnQnFEOzs7Z0JBckV2RG1CO2dCQWhCQUg7Z0JBb0NBUTtnQkFqQkFIO2dCQTBDQUs7Z0JBdEJBRDs7OztFIiwic291cmNlc0NvbnRlbnQiOlsib3BlbiBDb3JlXG5cbm1vZHVsZSBNYWtlIChJbmNyIDogSW5jcmVtZW50YWwuU19nZW4pID0gc3RydWN0XG4gIG1vZHVsZSBFID0gSW5jci5FeHBlcnRcblxuICAoKiBIYXNodGJsIHN0YXJ0cyBvdXQgYXQgYSByaWRpY3Vsb3VzIHNpemUgb2YgMTI4LiBUaGlzIGlzIGEgbW9yZSByZWFzb25hYmxlIG51bWJlclxuICAgICBvZiBiaW5zIHRvIGhhdmUuICopXG4gIGxldCBoYXNodGJsX3NpemUgPSAxMFxuXG4gICgqKiBbc2V0dXBfZ2VuZXJhdG9yXSBzZXRzIHVwIHRoZSBzdGFnZWQgY29udmVyc2lvbi5cblxuICAgICAgW2hhc2hhYmxlXSBpcyB1c2VkIHRvIGJ1aWxkIGEgdGFibGUgb2YgbmVjZXNzYXJ5IGRlcGVuZGVuY2llcy4gV2UgZHJvcCB1bm5lY2Vzc2FyeVxuICAgICAgZGVwZW5kZW5jaWVzIHRvIGFsbG93IHRoZW0gdG8gYmUgY29sbGVjdGVkLlxuXG4gICAgICBbY29tcHV0ZV9vdXRwdXQga2V5XSByZXR1cm5zIHRoZSB2YWx1ZSBvZiB0aGUgb3V0cHV0IG5vZGUgY29ycmVzcG9uZGluZyB0byBba2V5XS5cbiAgICAgIFtjb21wdXRlX291dHB1dF0gaXMgY2xvc2VkIG92ZXIgdGhlIG11dGFibGUgc3RhdGUgZGV0ZXJtaW5pbmcgdGhlIGN1cnJlbnQgdmFsdWUgb2ZcbiAgICAgIHRoZSBzZWxlY3RvcidzIGlucHV0LlxuXG4gICAgICBbbWFrZV9pbnB1dF9ub2RlXSBtYWtlcyBzdXJlIHRoYXQgd2hlbiB0aGUgbXV0YWJsZSBzdGF0ZSBpbnNpZGUgW2NvbXB1dGVfb3V0cHV0XSBpc1xuICAgICAgdXBkYXRlZCwgdGhlIGNvcnJlc3BvbmRpbmcgbm9kZXMgaW4gdGhlIFtuZWNlc3NhcnlfZGVwZW5kZW5jaWVzXSB0YWJsZSBhcmUgbWFkZVxuICAgICAgc3RhbGUuICAqKVxuICBsZXQgc2V0dXBfZ2VuZXJhdG9yXG4gICAgICAgIChoYXNoYWJsZSA6ICdhIEhhc2h0YmxfaW50Zi5IYXNoYWJsZS50KVxuICAgICAgICB+KGNvbXB1dGVfb3V0cHV0IDogJ2EgLT4gJ2IpXG4gICAgICAgIH4obWFrZV9pbnB1dF9ub2RlIDogbWFrZV9rZXlfc3RhbGU6KCdhIC0+IHVuaXQpIC0+IHVuaXQgSW5jci50KVxuICAgIDogKCdhIC0+ICdiIEluY3IudCkgU3RhZ2VkLnRcbiAgICA9XG4gICAgbGV0IG5lY2Vzc2FyeV9kZXBlbmRlbmNpZXMgPSBIYXNodGJsLlVzaW5nX2hhc2hhYmxlLmNyZWF0ZSB+c2l6ZTpoYXNodGJsX3NpemUgfmhhc2hhYmxlICgpIGluXG4gICAgbGV0IChpbnB1dF9ub2RlIDogdW5pdCBJbmNyLnQpID1cbiAgICAgIGxldCBtYWtlX2tleV9zdGFsZSBrZXkgPVxuICAgICAgICBIYXNodGJsLmZpbmQgbmVjZXNzYXJ5X2RlcGVuZGVuY2llcyBrZXlcbiAgICAgICAgfD4gT3B0aW9uLnZhbHVlIH5kZWZhdWx0OltdXG4gICAgICAgIHw+IExpc3QuaXRlciB+ZjpFLk5vZGUubWFrZV9zdGFsZVxuICAgICAgaW5cbiAgICAgIG1ha2VfaW5wdXRfbm9kZSB+bWFrZV9rZXlfc3RhbGVcbiAgICBpblxuICAgICgqIFNldCB0aGUgY3V0b2ZmIHNvIHRoYXQgd2UgbmV2ZXIgcGFzcyBhdXRvbWF0aWNhbGx5IGZyb20gdGhlIHVwZGF0ZSB0byB0aGUgbm9kZXMuIFdlXG4gICAgICAgd2FudCBldmVyeXRoaW5nIHRvIGdvIHRocm91Z2ggW21ha2Vfa2V5X3N0YWxlXSAqKVxuICAgIEluY3Iuc2V0X2N1dG9mZiBpbnB1dF9ub2RlIEluY3IuQ3V0b2ZmLmFsd2F5cztcbiAgICBzdGFnZSAoZnVuIGtleSAtPlxuICAgICAgbGV0IGlucHV0X2RlcCA9IEUuRGVwZW5kZW5jeS5jcmVhdGUgaW5wdXRfbm9kZSBpblxuICAgICAgbGV0IHJlYyBvdXRwdXRfbm9kZSA9IGxhenkgKFxuICAgICAgICBFLk5vZGUuY3JlYXRlXG4gICAgICAgICAgKGZ1biAoKSAtPiBjb21wdXRlX291dHB1dCBrZXkpXG4gICAgICAgICAgfm9uX29ic2VydmFiaWxpdHlfY2hhbmdlOihmdW4gfmlzX25vd19vYnNlcnZhYmxlIC0+XG4gICAgICAgICAgICBpZiBpc19ub3dfb2JzZXJ2YWJsZSB0aGVuXG4gICAgICAgICAgICAgIEhhc2h0YmwuYWRkX211bHRpIG5lY2Vzc2FyeV9kZXBlbmRlbmNpZXMgfmtleSB+ZGF0YTooZm9yY2Ugb3V0cHV0X25vZGUpXG4gICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgIEhhc2h0YmwuY2hhbmdlIG5lY2Vzc2FyeV9kZXBlbmRlbmNpZXMga2V5IH5mOihmdW5jdGlvblxuICAgICAgICAgICAgICAgIHwgTm9uZSAtPiBOb25lXG4gICAgICAgICAgICAgICAgfCBTb21lIGwgLT5cbiAgICAgICAgICAgICAgICAgIG1hdGNoIExpc3QuZmlsdGVyIGwgfmY6KEZuLm5vbiAocGh5c19lcXVhbCAoZm9yY2Ugb3V0cHV0X25vZGUpKSkgd2l0aFxuICAgICAgICAgICAgICAgICAgfCBbXSAtPiBOb25lXG4gICAgICAgICAgICAgICAgICB8IGwnIC0+IFNvbWUgbCdcbiAgICAgICAgICAgICAgKSkpXG4gICAgICBpblxuICAgICAgbGV0IG91dHB1dF9ub2RlID0gZm9yY2Ugb3V0cHV0X25vZGUgaW5cbiAgICAgIEUuTm9kZS5hZGRfZGVwZW5kZW5jeSBvdXRwdXRfbm9kZSBpbnB1dF9kZXA7XG4gICAgICBFLk5vZGUud2F0Y2ggb3V0cHV0X25vZGVcbiAgICApXG5cbiAgKCoqIFRoaXMgY3JlYXRlcyBhIHVuaXQgaW5jcmVtZW50YWwgdGhhdCBmaXJlcyB3aGVuZXZlciB0aGUgaW5wdXQgaW5jcmVtZW50YWxcbiAgICAgIGZpcmVzLiBXaGVuIHRoYXQgb2NjdXJzLCBpdCB1cGRhdGVzIFtzZWxlY3RlZF0gdG8gbWF0Y2ggdGhlIGN1cnJlbnQgdmFsdWUgb2ZcbiAgICAgIFtpbnB1dF0sIGFuZCBjYWxscyBbbWFrZV9rZXlfc3RhbGVdIGZvciBib3RoIHRoZSBvbGQgYW5kIG5ldyB2YWx1ZSBvZiB0aGVcbiAgICAgIGluY3JlbWVudGFsLiAqKVxuICBsZXQgdXBkYXRlX29uZSB+aW5wdXQgfnNlbGVjdGVkIH5tYWtlX3N0YWxlID1cbiAgICBJbmNyLm1hcCBpbnB1dCB+ZjooZnVuIGlucCAtPlxuICAgICAgT3B0aW9uLml0ZXIgaW5wIH5mOm1ha2Vfc3RhbGU7XG4gICAgICBPcHRpb24uaXRlciAhc2VsZWN0ZWQgfmY6bWFrZV9zdGFsZTtcbiAgICAgIHNlbGVjdGVkIDo9IGlucFxuICAgIClcblxuICBsZXQgc2VsZWN0X29uZSdcbiAgICAgICAgKHR5cGUgYSlcbiAgICAgICAgKG1vZHVsZSBIIDogSGFzaGFibGUuQ29tbW9uIHdpdGggdHlwZSB0ID0gYSlcbiAgICAgICAgKGlucHV0IDogYSBvcHRpb24gSW5jci50KVxuICAgID1cbiAgICBsZXQgc2VsZWN0ZWQgPSByZWYgTm9uZSBpblxuICAgIGxldCBjb21wdXRlX291dHB1dCBrZXkgPVxuICAgICAgbWF0Y2ggIXNlbGVjdGVkIHdpdGhcbiAgICAgIHwgTm9uZSAtPiBmYWxzZVxuICAgICAgfCBTb21lIGtleScgLT4gSC5jb21wYXJlIGtleSBrZXknID0gMFxuICAgIGluXG4gICAgbGV0IG1ha2VfaW5wdXRfbm9kZSB+bWFrZV9rZXlfc3RhbGUgPVxuICAgICAgdXBkYXRlX29uZSB+aW5wdXQgfnNlbGVjdGVkIH5tYWtlX3N0YWxlOm1ha2Vfa2V5X3N0YWxlXG4gICAgaW5cbiAgICBzZXR1cF9nZW5lcmF0b3IgSC5oYXNoYWJsZSB+Y29tcHV0ZV9vdXRwdXQgfm1ha2VfaW5wdXRfbm9kZVxuXG4gIGxldCBzZWxlY3Rfb25lIGggaW5wdXQgPVxuICAgIHNlbGVjdF9vbmUnIGggKEluY3IubWFwIH5mOk9wdGlvbi5zb21lIGlucHV0KVxuXG4gIGxldCBzZWxlY3Rfb25lX3ZhbHVlJ1xuICAgICAgICAodHlwZSBhKVxuICAgICAgICAobW9kdWxlIEggOiBIYXNoYWJsZS5Db21tb24gd2l0aCB0eXBlIHQgPSBhKVxuICAgICAgICB+ZGVmYXVsdFxuICAgICAgICBpbnB1dFxuICAgID1cbiAgICBsZXQgc2VsZWN0ZWQgPSByZWYgTm9uZSBpblxuICAgIGxldCBjb21wdXRlX291dHB1dCBrZXkgPVxuICAgICAgbWF0Y2ggIXNlbGVjdGVkIHdpdGhcbiAgICAgIHwgTm9uZSAtPiBkZWZhdWx0XG4gICAgICB8IFNvbWUgKGtleScsIGRhdGEpIC0+IGlmIEguY29tcGFyZSBrZXkga2V5JyA9IDAgdGhlbiBkYXRhIGVsc2UgZGVmYXVsdFxuICAgIGluXG4gICAgbGV0IG1ha2VfaW5wdXRfbm9kZSB+bWFrZV9rZXlfc3RhbGUgPVxuICAgICAgdXBkYXRlX29uZSB+c2VsZWN0ZWQgfmlucHV0IH5tYWtlX3N0YWxlOihmdW4gKGtleSwgXykgLT4gbWFrZV9rZXlfc3RhbGUga2V5KVxuICAgIGluXG4gICAgc2V0dXBfZ2VuZXJhdG9yIEguaGFzaGFibGUgfmNvbXB1dGVfb3V0cHV0IH5tYWtlX2lucHV0X25vZGVcblxuICBsZXQgc2VsZWN0X29uZV92YWx1ZSBoIH5kZWZhdWx0IGlucHV0ID1cbiAgICBzZWxlY3Rfb25lX3ZhbHVlJyBoIH5kZWZhdWx0IChJbmNyLm1hcCB+ZjpPcHRpb24uc29tZSBpbnB1dClcblxuICBsZXQgc2VsZWN0X21hbnlfdmFsdWVzXG4gICAgICAgICh0eXBlIGEpXG4gICAgICAgIChtb2R1bGUgSCA6IEhhc2hhYmxlLkNvbW1vbiB3aXRoIHR5cGUgdCA9IGEpXG4gICAgICAgIH5kZWZhdWx0XG4gICAgICAgIGlucHV0XG4gICAgPVxuICAgIGxldCBoYXNoYWJsZSA9IEguaGFzaGFibGUgaW5cbiAgICBsZXQgc2VsZWN0ZWQgPSBIYXNodGJsLlVzaW5nX2hhc2hhYmxlLmNyZWF0ZSB+c2l6ZTpoYXNodGJsX3NpemUgfmhhc2hhYmxlICgpIGluXG4gICAgbGV0IGNvbXB1dGVfb3V0cHV0IGtleSA9XG4gICAgICBIYXNodGJsLmZpbmQgc2VsZWN0ZWQga2V5IHw+IE9wdGlvbi52YWx1ZSB+ZGVmYXVsdFxuICAgIGluXG4gICAgbGV0IG1ha2VfaW5wdXRfbm9kZSB+bWFrZV9rZXlfc3RhbGUgPVxuICAgICAgSW5jci5tYXAgaW5wdXQgfmY6KGZ1biBpbnAgLT5cbiAgICAgICAgSGFzaHRibC5pdGVyX2tleXMgc2VsZWN0ZWQgfmY6bWFrZV9rZXlfc3RhbGU7XG4gICAgICAgIEhhc2h0YmwuY2xlYXIgc2VsZWN0ZWQ7XG4gICAgICAgIExpc3QuaXRlciBpbnAgfmY6KGZ1biAoa2V5LCBkYXRhKSAtPlxuICAgICAgICAgIG1ha2Vfa2V5X3N0YWxlIGtleTtcbiAgICAgICAgICBIYXNodGJsLnNldCBzZWxlY3RlZCB+a2V5IH5kYXRhXG4gICAgICAgICkpXG4gICAgaW5cbiAgICBzZXR1cF9nZW5lcmF0b3IgaGFzaGFibGUgfmNvbXB1dGVfb3V0cHV0IH5tYWtlX2lucHV0X25vZGVcblxuICBsZXQgc2VsZWN0X21hbnlcbiAgICAgICAgKHR5cGUgYSlcbiAgICAgICAgKG1vZHVsZSBIIDogSGFzaGFibGUuQ29tbW9uIHdpdGggdHlwZSB0ID0gYSlcbiAgICAgICAgaW5wdXRcbiAgICA9XG4gICAgbGV0IGhhc2hhYmxlID0gSC5oYXNoYWJsZSBpblxuICAgIGxldCBzZWxlY3RlZCA9IEhhc2hfc2V0LlVzaW5nX2hhc2hhYmxlLmNyZWF0ZSB+c2l6ZTpoYXNodGJsX3NpemUgfmhhc2hhYmxlICgpIGluXG4gICAgbGV0IGNvbXB1dGVfb3V0cHV0IGtleSA9IEhhc2hfc2V0Lm1lbSBzZWxlY3RlZCBrZXkgaW5cbiAgICBsZXQgbWFrZV9pbnB1dF9ub2RlIH5tYWtlX2tleV9zdGFsZSA9XG4gICAgICBJbmNyLm1hcCBpbnB1dCB+ZjooZnVuIGlucCAtPlxuICAgICAgICBsZXQgb2xkX3NldCA9IEhhc2hfc2V0LmNvcHkgc2VsZWN0ZWQgaW5cbiAgICAgICAgSGFzaF9zZXQuY2xlYXIgc2VsZWN0ZWQ7XG5cbiAgICAgICAgTGlzdC5pdGVyIGlucCB+ZjooZnVuIGtleSAtPlxuICAgICAgICAgIGlmIG5vdCAoSGFzaF9zZXQubWVtIG9sZF9zZXQga2V5KSB0aGVuXG4gICAgICAgICAgICBtYWtlX2tleV9zdGFsZSBrZXk7XG4gICAgICAgICAgSGFzaF9zZXQuYWRkIHNlbGVjdGVkIGtleVxuICAgICAgICApO1xuXG4gICAgICAgIEhhc2hfc2V0Lml0ZXIgb2xkX3NldCB+ZjooZnVuIGtleSAtPlxuICAgICAgICAgIGlmIG5vdCAoSGFzaF9zZXQubWVtIHNlbGVjdGVkIGtleSkgdGhlblxuICAgICAgICAgICAgbWFrZV9rZXlfc3RhbGUga2V5O1xuICAgICAgICApKVxuICAgIGluXG4gICAgc2V0dXBfZ2VuZXJhdG9yIGhhc2hhYmxlIH5jb21wdXRlX291dHB1dCB+bWFrZV9pbnB1dF9ub2RlXG5lbmRcblxuIl19
